<div>
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-unit);">
        <h1>items</h1>
        <button (click)="onCreateNew()">+ new item</button>
    </div>

    <fieldset>
        <legend>search & filters</legend>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-unit); margin-bottom: var(--space-unit);">
            <div>
                search:
                <input type="text" [value]="filters().search"
                    (input)="onSearchInputChange($any($event.target).value)"
                    placeholder="item code, description...">
            </div>

            <div>
                category:
                <select [value]="filters().category"
                    (change)="onCategoryInputChange($any($event.target).value)">
                    <option value="">all categories</option>
                    <option value="Electronics">electronics</option>
                    <option value="Machinery">machinery</option>
                    <option value="RawMaterials">raw materials</option>
                    <option value="Packaging">packaging</option>
                    <option value="Services">services</option>
                    <option value="Components">components</option>
                </select>
            </div>
        </div>

        <button (click)="clearFilters()">clear filters</button>
    </fieldset>

    @if (loading()) {
    <div style="text-align: center; padding: var(--space-unit);">
        loading items...
    </div>
    }

    @if (error()) {
    <div style="border: var(--border-width) solid rgb(var(--color-accent)); padding: var(--space-unit);">
        error: {{ error() }}
    </div>
    }

    @if (!loading() && !error()) {
    <div class="data-grid">
        <ag-grid-angular [rowData]="items()" [columnDefs]="columnDefs" [defaultColDef]="defaultColDef"
            [theme]="gridTheme" [rowSelection]="'single'" [animateRows]="true" [domLayout]="'normal'"
            (gridReady)="onGridReady($event)" (rowClicked)="onRowClicked($event)" style="height: 500px; width: 100%;">
        </ag-grid-angular>
    </div>

    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: var(--space-unit);">
        <p>showing {{ (currentPage() - 1) * pageSize() + 1 }} to {{ Math.min(currentPage() * pageSize(), totalCount()) }} of {{ totalCount() }} results</p>
        <div>
            <button (click)="onPageChange(currentPage() - 1)" [disabled]="!hasPrevPage()">← prev</button>
            @for (page of getPageNumbers(); track page) {
            <button (click)="onPageChange(page)" [style.text-decoration]="page === currentPage() ? 'underline' : 'none'">{{ page }}</button>
            }
            <button (click)="onPageChange(currentPage() + 1)" [disabled]="!hasNextPage()">next →</button>
        </div>
    </div>
    }
</div>